create sequence commune_sequence;  

create table commune (commune_name varchar(100) not null);
create unique index commune_idx99 on commune (commune_name);

alter table commune add CONSTRAINT "PK_COMMUNE" PRIMARY KEY ("COMMUNE_NAME");

create table commune
( commune_from varchar(100) not null
, commune_to varchar(100) not null
, distance integer not null
, duration integer not null); 

create index commune_idx0 on commune_distance (commune_from, commune_to);
create index commune_idx1 on commune_distance (commune_from);
create index commune_idx2 on commune_distance (commune_to);

insert into commune select distinct commune_to from commune_distance ;
commit; 

select * 
from   commune 
where  distance = (select min(distance) from commune where commune_from = 'ANTWERPEN' or commune_to = 'ANTWERPEN'  and distance > 0); 

ALTER TABLE commune_distance ADD CONSTRAINT FK01_COMMUNE_FROM FOREIGN KEY (commune_from) REFERENCES commune(COMMUNE_NAME);
ALTER TABLE commune_distance ADD CONSTRAINT FK02_COMMUNE_TO   FOREIGN KEY (commune_to) REFERENCES commune(COMMUNE_NAME);

SPECIFIC (15 gemeentes)
-----------------------

select *
from   commune_distance
where  distance = ( select min(distance)
                    from commune_distance
                    where (commune_from = 'EDEGEM' and commune_to in ('AALST', 'AARTSELAAR', 'ALSEMBERG', 'ANTWERPEN', 'BEERSEL', 'BERTEM', 'BEVEREN', 'BOOM', 'BRASSCHAAT', 'EDEGEM', 'HOVE', 'KONTICH', 'KORTENBERG', 'MORTSEL', 'SCHOTEN') )
                    or commune_to = 'EDEGEM' and commune_from in ('AALST', 'AARTSELAAR', 'ALSEMBERG', 'ANTWERPEN', 'BEERSEL', 'BERTEM', 'BEVEREN', 'BOOM', 'BRASSCHAAT', 'EDEGEM', 'HOVE', 'KONTICH', 'KORTENBERG', 'MORTSEL', 'SCHOTEN') )
and    ( commune_from = 'EDEGEM' or commune_to = 'EDEGEM');

MIN
--- 

select * 
from   commune_distance
where  distance = (select min(distance) from commune_distance where commune_from = 'AALST' or commune_to = 'AALST')
and    ( commune_from = 'AALST' or commune_to = 'AALST');    

select * 
from   commune_distance
where  distance = (select min(distance) from commune_distance where commune_from = 'EDEGEM' or commune_to = 'EDEGEM')
and    ( commune_from = 'EDEGEM' or commune_to = 'EDEGEM');   

MAX
--- 

select * 
from   commune_distance
where  distance = (select max(distance) from commune_distance where commune_from = 'AALST' or commune_to = 'AALST')
and    ( commune_from = 'AALST' or commune_to = 'AALST');    

select commune_from, count(*) 
from   commune_distance 
group by commune_from
order by 2 desc 

select commune_from, count(*) 
from   commune_distance 
group by commune_from
order by 1 asc 
